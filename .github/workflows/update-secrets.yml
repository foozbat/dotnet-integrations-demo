name: 'Update Key Vault Secrets'

on:
  workflow_dispatch:

jobs:
  update-secrets:
    name: 'Update Key Vault Secrets'
    runs-on: ubuntu-latest

    steps:
    - name: Azure Login
      uses: azure/login@v2
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}

    - name: Set Key Vault secrets
      run: |
        az keyvault secret set --vault-name integrations-demo-vault --name "azure-logic-app-url" --value "${{ secrets.AZURE_LOGIC_APP_URL }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "azure-sql-connection-string" --value "${{ secrets.AZURE_SQL_CONNECTION_STRING }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "stripe-api-key" --value "${{ secrets.STRIPE_API_KEY }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "stripe-price-id" --value "${{ secrets.STRIPE_PRICE_ID }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "stripe-webhook-secret" --value "${{ secrets.STRIPE_WEBHOOK_SECRET }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "zapier-webhook-url" --value "${{ secrets.ZAPIER_WEBHOOK_URL }}"
        az keyvault secret set --vault-name integrations-demo-vault --name "sentry-dsn" --value "${{ secrets.SENTRY_DSN }}"
